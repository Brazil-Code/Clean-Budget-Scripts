CREATE TABLE BUDGET (
    ID SERIAL,
    SERVICE_TYPE VARCHAR (255) NOT NULL,
    BUDGETED FLOAT NOT NULL,
    EFFECTIVE FLOAT NOT NULL,
    MANAGEMENT_ACCOUNT VARCHAR (255) NOT NULL,
    DEPARTAMENT VARCHAR (255) NOT NULL,
    YEAR VARCHAR (4) NOT NULL,
    DISABLED BOOLEAN NOT NULL,
    UPDATED_AT TIMESTAMP,
    CREATED_AT TIMESTAMP NOT NULL,
    CONSTRAINT PK_BUDGET PRIMARY KEY (ID)
);

ALTER TABLE BUDGET ALTER COLUMN DISABLED SET DEFAULT FALSE;

CREATE TABLE AREA (
    ID SERIAL,
    ID_BUDGET INT NOT NULL,
    NAME VARCHAR(255) NOT NULL,
    DISABLED BOOLEAN NOT NULL,
    CONSTRAINT PK_AREA PRIMARY KEY (ID),
    CONSTRAINT FK_AREA_BUDGET FOREIGN KEY (ID_BUDGET) REFERENCES BUDGET (ID)
);

ALTER TABLE AREA ALTER COLUMN DISABLED SET DEFAULT FALSE;

CREATE TABLE "USER" (
    ID SERIAL,
    ID_AREA INT NOT NULL,
    USERNAME VARCHAR (50) NOT NULL,
    PASSWORD VARCHAR (50) NOT NULL,
    FIRST_NAME VARCHAR (30) NOT NULL,
    LAST_NAME VARCHAR (30),
    EMAIL VARCHAR (100),
    TOKEN TEXT,
    DISABLED BOOLEAN NOT NULL,
    UPDATED_AT TIMESTAMP,
    CREATED_AT TIMESTAMP NOT NULL,
    CONSTRAINT PK_USER PRIMARY KEY (ID),
    CONSTRAINT FK_USER_AREA FOREIGN KEY (ID_AREA) REFERENCES AREA (ID)
);

ALTER TABLE "user" ALTER COLUMN DISABLED SET DEFAULT FALSE;
ALTER TABLE "user" ADD CONSTRAINT UK_USER_USERNAME UNIQUE (USERNAME);

CREATE TABLE LOG (
    ID SERIAL,
    ID_USER INT NOT NULL,
    IP VARCHAR (20),
    DESCRIPTION VARCHAR(255) NOT NULL,
    CONSTRAINT PK_LOG PRIMARY KEY (ID),
    CONSTRAINT FK_LOG_USER FOREIGN KEY (ID_USER) REFERENCES "user" (ID)
 );