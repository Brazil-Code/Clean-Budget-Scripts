CREATE TABLE PROFILE (
    ID SERIAL,
    DESCRIPTION VARCHAR (50) NOT NULL,
    DISABLED BOOLEAN NOT NULL,
    CONSTRAINT PK_PROFILE PRIMARY KEY (ID)
);

ALTER TABLE PROFILE ALTER COLUMN DISABLED SET DEFAULT FALSE;

CREATE TABLE USER_PROFILE (
    ID_USER INT NOT NULL,
    ID_PROFILE INT NOT NULL,
    CONSTRAINT PK_USER_PROFILE PRIMARY KEY (ID_USER, ID_PROFILE),
    CONSTRAINT FK_USER_PROFILE_PROFILE FOREIGN KEY (ID_PROFILE) REFERENCES PROFILE (ID),
    CONSTRAINT FK_USER_PROFILE_USER FOREIGN KEY (ID_USER) REFERENCES "user" (ID)
);

CREATE TABLE FUNCTIONALITY (
    ID SERIAL,
    DESCRIPTION VARCHAR (50) NOT NULL,
    DISABLED BOOLEAN NOT NULL,
    URI VARCHAR (150) NOT NULL,
    ACTION INT,
    CONSTRAINT PK_FUNCTIONALITY PRIMARY KEY (ID)
);

ALTER TABLE PROFILE ALTER COLUMN DISABLED SET DEFAULT FALSE;

CREATE TABLE PROFILE_FUNCTIONALITY (
    ID_PROFILE INT NOT NULL,
    ID_FUNCTIONALITY INT NOT NULL,
    CONSTRAINT PK_PROFILE_FUNCTIONALITY PRIMARY KEY (ID_PROFILE, ID_FUNCTIONALITY),
    CONSTRAINT FK_PROFILE_FUNCTIONALITY_PROFILE FOREIGN KEY (ID_PROFILE) REFERENCES PROFILE (ID),
    CONSTRAINT FK_PROFILE_FUNCTIONALITY_FUNCTIONALITY FOREIGN KEY (ID_FUNCTIONALITY) REFERENCES FUNCTIONALITY (ID)
);